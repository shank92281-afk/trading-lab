<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Trading Lab â€” Signup</title>
</head>
<body>
  <h1>Sign Up</h1>

  <div style="max-width:360px;">
    <label>Username</label><br>
    <input id="username" type="text" style="width:100%; padding:8px;"><br><br>

    <label>Password</label><br>
    <input id="password" type="password" style="width:100%; padding:8px;"><br><br>

    <button onclick="signup()" style="padding:8px 12px;">Create Account</button>
    <p id="msg"></p>

    <p>Already have an account? <a href="login.html">Login</a></p>
  </div>

<script>
const AUTH_BASE = "http://localhost:8004";

async function signup(){
  const username = document.getElementById("username").value.trim();
  const password = document.getElementById("password").value;

  if(!username || !password){
    document.getElementById("msg").innerText = "Provide username and password.";
    return;
  }

  try {
    const res = await fetch(AUTH_BASE + "/signup", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ username, password })
    });

    const data = await res.json().catch(()=>({error: "invalid json"}));

    if(res.ok){
      document.getElementById("msg").innerText = "Signup successful. Redirecting to login...";
      setTimeout(()=> location.href = "login.html", 1000);
    } else {
      document.getElementById("msg").innerText = (data.detail || data.error || JSON.stringify(data));
    }
  } catch(err){
    document.getElementById("msg").innerText = "Network error: " + err.message;
  }
}
</script>
</body>
</html>

