<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>Trading Lab — Demo UI</title>
  <style>
    body{font-family: Inter, system-ui, Arial; max-width:820px;margin:32px auto;color:#111}
    input, button { padding:8px; margin:6px 0; width:100%; box-sizing:border-box}
    .row{display:flex; gap:8px}
    .small{width:40%}
    pre{background:#f6f8fa;padding:12px;border-radius:6px; overflow:auto}
  </style>
</head>
<body>
  <h2>Trading Lab — Demo UI</h2>

  <section id="trade">
    <h3>Place Order</h3>

    <input id="symbol" placeholder="Symbol (e.g. ABC)" />
    <div class="row">
      <input id="price" placeholder="Price" class="small" />
      <input id="qty" placeholder="Quantity" class="small" />
    </div>

    <button id="btn_place">Place Order</button>

    <h4>Order Response</h4>
    <pre id="order_response">{}</pre>

    <h4>Trade Confirmation</h4>
    <pre id="trade_confirm">{}</pre>
    <button id="btn_refresh_trade">Refresh Trade</button>
  </section>

<script>
function setJson(id, obj) {
  document.getElementById(id).innerText = JSON.stringify(obj, null, 2);
}

document.getElementById('btn_place').onclick = async () => {
  const symbol = document.getElementById('symbol').value || "ABC";
  const price = parseFloat(document.getElementById('price').value) || 100;
  const qty   = parseInt(document.getElementById('qty').value) || 1;
  const orderId = "ui-" + Date.now();

  const payload = { id: orderId, price, qty, symbol };

  try {
    const res = await fetch("http://localhost/place_order", {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify(payload)
    });

    const json = await res.json();
    setJson("order_response", json);
    localStorage.setItem("last_order", orderId);

  } catch (e) {
    setJson("order_response", { error: e.toString() });
  }
};

document.getElementById('btn_refresh_trade').onclick = async () => {
  const orderId = localStorage.getItem("last_order");
  if (!orderId) {
    setJson("trade_confirm", { error: "No last order" });
    return;
  }

  try {
    const res = await fetch("http://localhost/trade/" + orderId);
    const json = await res.json();
    setJson("trade_confirm", json);

  } catch (e) {
    setJson("trade_confirm", { error: e.toString() });
  }
};
</script>

</body>
</html>
